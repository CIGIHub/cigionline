{% extends "base.html" %}

{% load wagtailcore_tags wagtailimages_tags webpack_loader static core_tags %}

{% block meta_description %}
  {% if self.subtitle %}
    <meta name="description" content="{{ self.subtitle|striptags }}" />
  {% endif %}
{% endblock %}
{% block og_description %}
  {% if self.subtitle %}
    <meta property="og:description" content="{{ self.subtitle|striptags }}" />
  {% endif %}
{% endblock %}
{% block og_type %}
  <meta property="og:type" content="article" />
{% endblock %}
{% block og_image %}
  {% if self.image_social %}
    {% image self.image_social fill-1600x900 as og_image %}
  {% elif self.image_hero %}
    {% image self.image_hero fill-1600x900 as og_image %}
  {% endif %}
  {% if og_image %}
    <meta property="og:image" content="{{ og_image.url }}" />
  {% else %}
    {% include "includes/og_image_default.html" %}
  {% endif %}
{% endblock %}
{% block extra_og_meta %}
  {% if self.publishing_date %}
    <meta property="article:published_time" content="{{ self.publishing_date|date:'c' }}" />
  {% endif %}
{% endblock %}

{% block extra_fonts %}
  <link rel="stylesheet" href="https://use.typekit.net/nyt4kej.css">
{% endblock %}
{% block extra_css %}
  {% render_bundle 'themePolicyPrompt' 'css' %}
  {% render_bundle 'themePolicyPrompt' 'svg' %}
{% endblock %}
{% block extra_js %}
  {% render_bundle 'themePolicyPrompt' 'js' attrs='defer' %}
{% endblock %}

{% block body_class %}policy-prompt-multimedia{% endblock %}

{% block header %}
  {% include "includes/top_bar.html" with small=True %}
{% endblock header %}

{% block content %}
  <section class="hero">
    <div class="container">
      <div class="row justify-content-center">
        <div class="col-md-10 col-lg-8">
          <div class="row justify-content-between">
            <div class="col-4 col-md-2">
              <div class="policy-prompt-logo">
                <a href="/policy-prompt-podcast">
                  <img src="{% static 'assets/policy_prompt_logo.png' %}" alt="Policy Prompt Logo" />
                </a>
              </div>
            </div>
            <div class="col-md-4">
              <div class="subscribe-share">
                <div class="dropdowns">
                  <div class="dropdown">
                    SUBSCRIBE
                    <i class="fa fa-headphones"></i>
                    <ul class="dropdown-menu">
                      <li>
                        <button>
                          <a href="" target="_blank" rel="noopener noreferrer">
                            Apple Podcasts
                          </a>
                        </button>
                      </li>
                      <li>
                        <button>
                          <a href="" target="_blank" rel="noopener noreferrer">
                            Spotify
                          </a>
                        </button>
                      </li>
                      <li>
                        <button>
                          <a href="" target="_blank" rel="noopener noreferrer">
                            Pocket Casts
                          </a>
                        </button>
                      </li>
                      <li>
                        <button>
                          <a href="" target="_blank" rel="noopener noreferrer">
                            Youtube Music
                          </a>
                        </button>
                      </li>
                      <li>
                        <button>
                          <a href="" target="_blank" rel="noopener noreferrer">
                            Amazon Music
                          </a>
                        </button>
                      </li>
                    </ul>
                  </div>
                  <div class="dropdown">
                    SHARE
                    <i class="fa-solid fa-share"></i>
                    <ul class="dropdown-menu">
                      <li>
                        <button>
                          <a href="" target="_blank" rel="noopener noreferrer">
                            Facebook
                          </a>
                        </button>
                      </li>
                      <li>
                        <button>
                          <a href="" target="_blank" rel="noopener noreferrer">
                            X
                          </a>
                        </button>
                      </li>
                      <li>
                        <button>
                          <a href="" target="_blank" rel="noopener noreferrer">
                            LinkedIn
                          </a>
                        </button>
                      </li>
                    </ul>
                  </div>
                </div>
                <div class="follow">
                  Follow: 
                  <a href="" target="_blank" rel="noopener noreferrer">
                    <i class="fa-brands fa-x-twitter"></i>
                  </a>
                  <a href="" target="_blank" rel="noopener noreferrer">
                    <i class="fa-brands fa-square-instagram"></i>
                  </a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="row justify-content-center">
        <div class="col-md-10 col-lg-8">
          <div class="hero-content">
            <div class="episode-number">Episode {{ self.podcast_episode }}</div>
            <h1 id="animated-title">{{ self.title|split_to_spans|safe }}</h1>
            <div class="subtitle">
              {{ self.subtitle|richtext}}
            </div>
            <div class="podcast-player">
              <audio id="podcast-player" src="{{ self.multimedia_url }}"></audio>
            </div>
          </div>
        </div>
      </div>
      <div class="row justify-content-center">
        <div class="col-md-10 col-lg-8">
          {% image self.image_hero width-1920 %}
        </div>
      </div>
      <div class="row justify-content-center">
        <div class="col-md-10 col-lg-8">
          <hr>
        </div>
      </div>
    </div>
  </section>
  {% include "includes/body.html" with body=self.body heading="Episode Description" %}
  <section class="episode-info">
    <div class="container">
      <div class="row justify-content-center">
        <div class="col-12 col-md-10 col-lg-8">
          <div class="episode-info-container">
            <div class="episode-info-item">
              <div class="episode-length">{{ self.podcast_episode_minutes }} Minutes</div>
            </div>
            <span>\</span>
            <div class="episode-info-item">
              <div class="episode-info-value">Recorded {{ self.podcast_recording_date|date:"F j, Y" }}</div>
            </div>
            <span>\</span>
            <div class="episode-info-item">
              <div class="episode-info-value">Published {{ self.publishing_date|date:"F j, Y" }}</div>
            </div>
            <span>\</span>
            <div class="episode-info-item">
              <a href="#chapters">Chapters</a>
            </div>
            <span>\</span>
            <div class="episode-info-item">
              <a href="#transcript">Transcript</a>
            </div>
          </div>
          <hr>
        </div>
      </div>
    </div>
  </section>
  <section class="episode-guests">
    <div class="container">
      <div class="row justify-content-center">
        <div class="col-12 col-md-10 col-lg-8">
          <h2>Featuring</h2>
          <div class="episode-guests-list">
            {% for guest in self.podcast_guests %}
              {% if guest.block_type == 'guest_page' %}
                {% include_block guest %}
              {% endif %}
            {% endfor %}
          </div>
          <hr>
        </div>
      </div>
    </div>
  </section>

  {% with podcast_chapters=self.podcast_chapters %}
    {% if podcast_chapters %}
      <section class="episode-chapters">
        <div class="container">
          <div class="row justify-content-center">
            <div class="col col-md-10 col-lg-8">
              <h2>Chapters</h2>
              {% for chapter in podcast_chapters %}
                {% include_block chapter with chapter_num=forloop.counter %}
              {% endfor %}
              <hr>
            </div>
          </div>
        </div>
      </section>
    {% endif %}
  {% endwith %}

  {% with transcript=self.transcript %}
    {% if transcript %}
      <section class="episode-transcript">
        <div class="container">
          <div class="row justify-content-center">
            <div class="col col-md-10 col-lg-8">
              <h2>Transcript</h2>
              {% for block in transcript %}
                {% if block.block_type == 'transcript_block' %}
                  {% include_block block %}
                {% endif %}
              {% endfor %}
              <hr>
            </div>
          </div>
        </div>
      </section>
    {% endif %}
  {% endwith %}

  {% with next_episode=self.next_episode %}
    {% if next_episode %}
      <section class="next-episode">
        <div class="container">
          <div class="row justify-content-center">
            <div class="col-12 col-md-10 col-lg-8">
              <a href="{% pageurl next_episode %}">
                VIEW NEXT EPISODE >
              </a>
            </div>
          </div>
        </div>
      </section>
    {% endif %}
  {% endwith %}

  <section class="related">
    <div class="container">
      <div class="row justify-content-center">
        <div class="col-12 col-md-10 col-lg-8">
          <h2>Related</h2>
          <div class="recommended-list">
            {% for recommended_content in self.recommended_content|slice:":3" %}
              {% with recommended_content.specific as recommended_content %}
                <article>
                  <div class="row">
                    <div class="col-12 col-md-4">
                      <a href="{% pageurl recommended_content %}" class="image">
                        <div class="img-wrapper">
                          {% image recommended_content.image_hero fill-780x585 %}
                        </div>
                      </a>
                    </div>
                    <div class="col-12 col-md-8">
                      <div class="recommended-text">
                        <div class="episode-number">Episode {{ recommended_content.podcast_episode }}</div>
                        <h3><a href="{% pageurl recommended_content %}">{{ recommended_content.title }}</a></h3>
                        <div class="subtitle">{{ recommended_content.subtitle|richtext }}</div>
                        <div class="date">{{ recommended_content.publishing_date|date:"F j, Y" }}</div>
                      </div>
                    </div>
                  </div>
                </article>
              {% endwith %}
            {% endfor %}
          </div>
        </div>
      </div>
    </div>
  </section>

  {% block recommended %}
    {% if self.recommended_content %}
      <section class="recommended">
      </section>
    {% endif %}
  {% endblock recommended %}
{% endblock content %}

{% block footer %}
  {% include "./includes/footer.html" with podcast_subscribe_buttons=self.multimedia_series.specific.podcast_subscribe_buttons %}
{% endblock %}
