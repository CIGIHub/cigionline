{% load wagtailcore_tags menu_tags cache %}


<header class="{% if small %}small scrolled{% endif %} header--top-bar">
  {% cache 86400 top_bar %}
    {% get_menu_items 'main' as main_menu_items %}
    {% get_menu_items 'footer' as footer_menu_items %}

    <div class="main-navigation-wrapper">
      <div class="container">
        <div class="row">
          <div class="col cigi-top-bar" id="global-nav">
            <a class="cigi-logo" href="/">
              {% include './header_cigi_logo_large.svg' %}
              {% include './header_cigi_logo_small.svg' %}
            </a>
            <nav aria-label="primary">
              <button type="button"><i class="far fa-search"></i></button>
              <div class="btn-group">
                <button type="button" class="btn dropdown-toggle" data-bs-toggle="dropdown"
                  aria-haspopup="true" aria-expanded="false">
                  <i class="far fa-bars"></i>
                  <i class="far fa-times"></i>
                </button>
                <div class="dropdown-menu dropdown-menu-end">
                  {% for menu_item in main_menu_items %}
                    {% if menu_item.link_page %}
                      <button class="dropdown-item" type="button">
                        <a href="{% pageurl menu_item.link_page %}">
                          {{ menu_item.title }}
                        </a>
                      </button>
                    {% elif menu_item.link_url %}
                      <button class="dropdown-item" type="button">
                        <a href="{{ menu_item.link_url }}">
                          {{ menu_item.title }}
                        </a>
                      </button>
                    {% endif %}
                  {% endfor %}
                </div>
              </div>
            </nav>
          </div>
        </div>
      </div>
    </div>
    <div class="custom-popup-wrapper popup-search" id="popup-search">
      <div class="custom-popup-inner">
        <div class="container">
          <div class="row">
            <div class="col custom-popup-content custom-popup-nav-search">
              <form action="{% url 'search' %}" method="get" autocomplete="off">
                <div class="input-group input-group-search">
                  <input type="text" class="form-control" id="nav-search-input" name="query" placeholder="Keyword Search" aria-label="search-bar"
                    aria-describedby="search-bar" required>
                  <div class="nav-search-input-dropdown" id="nav-search-input-dropdown">
                    <div id="nav-search-input-dropdown-count"></div>
                    <ul class="nav-search-input-dropdown-list" id="nav-search-input-dropdown-list"></ul>
                  </div>
                  <div class="input-group-append">
                    <button class="btn-search" type="submit" id="search-bar">
                      <i class="far fa-search"></i>
                    </button>
                  </div>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>
  {% endcache %}
</header>
